---
title: "Clustering Mango Dataset using K-Means"
author: "Muhammad Athanabil Andi Fawazdhia"
date: "2022-12-16"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```
# Preliminary
K-Means is one of many algorithms that can do clustering or unsupervised task.
K-Means find label using metrics distances, widely using Euclidean distances.
In this projects, i want to find label (large/medium/small) from Mango dataset using k-means

# Library Used
```{r}
library(factoextra)
library(tidyverse)
library(cluster) 
library(ggplot2) 
library(dplyr) 
library(broom) 
library(ggdendro) 
library(readxl)
library(fmsb)
library(NbClust)
library(RColorBrewer)
library(gridExtra)
```
# Data Used
```{r}
data <- read_excel("C:/Users/ASUS/Downloads/Nabil/Projek/Dataset_Mango Classification.xlsx")
data <- as.data.frame(data)
rownames(data) <- data$Mango_Types
data <- data[,-1:-2]
head(data)
```
# Exploratory Data Analyst
## Check Dimension Data
```{r}
dim(data)
```
Data have 15 rows and 6 columns

## Check Type Each Variable
```{r}
str(data)
```
Type variable Mango_Sahpe, Mango_LeafShape and Mango_Color as characther and the rest are numeric

## Making Histogram for Each Numeric Variabel
```{r}
par(mfrow=c(2,2))
hist(data[,4], col="yellow", main = "Mango_Weight")
hist(data[,5], col="red", main = "Mango_Length")
hist(data[,6], col="cyan", main = "Mango_Circumference")
```

## Making Plot for Numeric Variable
```{r}
plot(data, col="cyan")
```

## Making Boxplot for Numeric Variable
```{r}
boxplot(data[,4:6])
```

There are one outlier in Mango_Circumference

# Preprocessing
## Label Encoding
```{r}
data$Mango_Shape <- as.numeric(factor(data$Mango_Shape))
data$Mango_LeafShape <- as.numeric(factor(data$Mango_LeafShape))
data$Mango_Color <- as.numeric(factor(data$Mango_Color))
head(data)
```
Label Encoding have a goal to transform categorical data to numeric.

## Normalization
```{r}
data_norm <- scale(data)
head(data_norm)
```
scale() is a function to do Normalization in R Studio, the goal is to change the scala data for example 1000,10,100 to range -3 to 3 using Z Score formula.

# K-Means Clustering
```{r}
set.seed(123)
#making prediction label using kmeans
km_label = kmeans(data_norm, 3)
```
## Making a Plot Clustering
```{r}
#making plot cluster
fviz_cluster(km_label, data = data)
```

Plot result that k-means succes making 3 clusters from dataset.

## Making a New DataFrame
```{r}
#making new dataframe
df <- cbind(data, km_label$cluster)
df_final <- data.frame(df)
df_final
```
## Making polygon plot
```{r}
new <- aggregate(df[,-ncol(df)], list(df[,ncol(df)]), mean)
new
# Set graphic colors
library(RColorBrewer)
coul <- brewer.pal(3, 'Dark2')
colors_border <- coul
library(scales)
colors_in <- alpha(coul, 0.3)

radarchart( new[,-1], axistype=0 , maxmin=F,
    #custom polygon
    pcol=colors_border, pfcol=colors_in, plwd=4, plty=1,
    #custom the grid
    cglcol="grey", cglty=1, axislabcol="black", cglwd=0.8, 
    #custom labels
    vlcex=0.8 
    )

# Add a legend
legend(x=1.7, y=1, legend = new$Group.1, bty = "n", pch=20, col=colors_in, text.col = "grey", cex=1.2, pt.cex=3)
```

## Conclusion
Members of Cluster 2 show dominant value in Weight, length & circumference so we can conclude that mango in cluster 2 have large size, then followed up by cluster 3 as medium size, and cluster 1 as small size.